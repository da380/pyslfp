<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="pygeoinf.hilbert_space" href="../api/hilbert_space.html" /><link rel="prev" title="Tutorial 6 - Minumum norm inversions" href="t6.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.07.19 -->
        <title>Tutorial 7 - Bayesian inversions - pygeoinf documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pygeoinf  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">pygeoinf  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="t1.html">Tutorial 1 - A first example</a></li>
<li class="toctree-l1"><a class="reference internal" href="t2.html">Tutorial 2 - Hilbert spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="t3.html">Tutorial 3 - Dual spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="t4.html">Tutorial 4 - Linear operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="t5.html">Tutorial 5 - Gaussian measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="t6.html">Tutorial 6 - Minumum norm inversions</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial 7 - Bayesian inversions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/hilbert_space.html">pygeoinf.hilbert_space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/operators.html">pygeoinf.operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/forms.html">pygeoinf.forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/gaussian_measure.html">pygeoinf.gaussian_measure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/direct_sum.html">pygeoinf.direct_sum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/linear_solvers.html">pygeoinf.linear_solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/forward_problem.html">pygeoinf.forward_problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/inversion.html">pygeoinf.inversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/linear_optimisation.html">pygeoinf.linear_optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/linear_bayesian.html">pygeoinf.linear_bayesian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/random_matrix.html">pygeoinf.random_matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/symmetric_spaces.html">Symmetric Spaces</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/t7.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment and run this when using colab.</span>
<span class="c1">#%pip install pygeoinf</span>
</pre></div>
</div>
</div>
<section id="Tutorial-7---Bayesian-inversions">
<h1>Tutorial 7 - Bayesian inversions<a class="headerlink" href="#Tutorial-7---Bayesian-inversions" title="Link to this heading">¶</a></h1>
<p>Building on Tutorial 6, we consider in furter detail the solution on our linear inverse problem using Bayesian methods. The set up of the foward problem is identical:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pygeoinf</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">inf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoinf.symmetric_space.circle</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sobolev</span>

<span class="c1"># Set the Sobolev parameters for the model space.</span>
<span class="n">order</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">length_scale</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Set the model space.</span>
<span class="n">model_space</span> <span class="o">=</span> <span class="n">Sobolev</span><span class="o">.</span><span class="n">from_sobolev_parameters</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">length_scale</span><span class="p">,</span> <span class="n">power_of_two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The discretised model space has dimension: </span><span class="si">{</span><span class="n">model_space</span><span class="o">.</span><span class="n">dim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Set up the observation points.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">observation_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Set the forward operator</span>
<span class="n">forward_operator</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">point_evaluation_operator</span><span class="p">(</span><span class="n">observation_points</span><span class="p">)</span>

<span class="c1"># Set the data space.</span>
<span class="n">data_space</span> <span class="o">=</span> <span class="n">forward_operator</span><span class="o">.</span><span class="n">codomain</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The data space has dimension: </span><span class="si">{</span><span class="n">data_space</span><span class="o">.</span><span class="n">dim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># First define a Gaussian measure on the model space.</span>
<span class="n">error_length_scale</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">error_amplitude</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">heat_gaussian_measure</span><span class="p">(</span><span class="n">error_length_scale</span><span class="p">,</span> <span class="n">error_amplitude</span><span class="p">)</span>

<span class="c1"># Push forward the measure under the forward operator.</span>
<span class="n">nu</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">affine_mapping</span><span class="p">(</span><span class="n">operator</span><span class="o">=</span><span class="n">forward_operator</span><span class="p">)</span>

<span class="c1"># Extract the covariance matrix and use this to define the desired measure.</span>
<span class="n">covariance_matrix</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">covariance</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">dense</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_error_measure</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">GaussianMeasure</span><span class="o">.</span><span class="n">from_covariance_matrix</span><span class="p">(</span><span class="n">data_space</span><span class="p">,</span> <span class="n">covariance_matrix</span><span class="p">)</span>

<span class="c1"># Get the standard deviations for each datum for use in plotting.</span>
<span class="n">standard_deviations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data_space</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_space</span><span class="o">.</span><span class="n">dim</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">data_space</span><span class="o">.</span><span class="n">basis_vector</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">standard_deviations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data_space</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">data_error_measure</span><span class="o">.</span><span class="n">covariance</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">v</span><span class="p">))</span>

<span class="c1"># Set the forward problem.</span>
<span class="n">forward_problem</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">LinearForwardProblem</span><span class="p">(</span><span class="n">forward_operator</span><span class="p">,</span> <span class="n">data_error_measure</span><span class="o">=</span><span class="n">data_error_measure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The discretised model space has dimension: 2048
The data space has dimension: 30
</pre></div></div>
</div>
<p>The main new feature within the Bayesian approach to the inverse problem is the specification of a prior measure on the model space. Here we select the expectation of the prior directly and chose its covariance from one the standard options that have been implemented within the <code class="docutils literal notranslate"><span class="pre">Sobolev</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the model prior expectation.</span>
<span class="n">expectation</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">project_function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">th</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">th</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">th</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Set the model prior.</span>
<span class="n">covariance_length_scale</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">covariance_amplitude</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">model_prior_measure</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">heat_gaussian_measure</span><span class="p">(</span><span class="n">covariance_length_scale</span><span class="p">,</span> <span class="n">covariance_amplitude</span><span class="p">,</span> <span class="n">expectation</span><span class="o">=</span><span class="n">expectation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Using this measure, we can generate a model and corresponding data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">forward_problem</span><span class="o">.</span><span class="n">synthetic_model_and_data</span><span class="p">(</span><span class="n">model_prior_measure</span><span class="p">)</span>

<span class="c1"># Plot the model and associated data.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">observation_points</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">standard_deviations</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t7_6_0.png" src="../_images/tutorials_t7_6_0.png" />
</div>
</div>
<p>To set up the <code class="docutils literal notranslate"><span class="pre">LinearBayesianInversion</span></code> class we provide the forward problem and the model prior:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bayesian_inversion</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">LinearBayesianInversion</span><span class="p">(</span><span class="n">forward_problem</span><span class="p">,</span> <span class="n">model_prior_measure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It can be shown that the model posterior measure is also Gaussian with expectation</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\overline{u}_{\mathrm{post}} = \overline{u} +  Q A^{*} (AQA^{*} + R)^{-1}(v - A\overline{u})\]</div>
</div>
<p>and covariance</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q_{\mathrm{post}} = Q - Q A^{*} (AQA^{*} + R)^{-1} AQ,\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\overline{u}\)</span> is the prior expectation and <span class="math notranslate nohighlight">\(Q\)</span> the prior covariance. We call <span class="math notranslate nohighlight">\(AQA^{*}+R\)</span> the <strong>normal operator</strong> for this problem. It can be accessed through:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_operator</span> <span class="o">=</span> <span class="n">bayesian_inversion</span><span class="o">.</span><span class="n">normal_operator</span>
</pre></div>
</div>
</div>
<p>Direct access to this operator is potentially useful in building preconditioners. Note that this operator is self-adjoint, positive-definite, and defined on the finite-dimensional model space which, in almost all cases, will be standard Euclidean space.</p>
<p>To solve the Bayesian inverse problem we use the method <code class="docutils literal notranslate"><span class="pre">model_posterior_measure</span></code> which takes as input the data and a <code class="docutils literal notranslate"><span class="pre">LinearSolver</span></code> and returns the desired measure. Optionally, a preconditioner for the normal operator can be provided that can be used in combination with an <code class="docutils literal notranslate"><span class="pre">IterativeLinearSolver</span></code>.</p>
<p>When the dimension of the data space is relatively small, it is often sufficient to use a simple Cholesky solver. This has a comparatively high upfront cost of forming and factoring the dense matrix representation, but once this is done the action of the posterior covariance can be determined at a low cost.</p>
<p>In the code below we obtain the posterior measure and compare its expected value to the true model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the posterior distribution.</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">CholeskySolver</span><span class="p">()</span>
<span class="n">model_posterior_measure</span> <span class="o">=</span> <span class="n">bayesian_inversion</span><span class="o">.</span><span class="n">model_posterior_measure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span>

<span class="c1"># Plot the posterior expectation.</span>
<span class="c1"># Plot the model and associated data and the least squares solution.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">observation_points</span><span class="p">,</span> <span class="n">data</span> <span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">standard_deviations</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_posterior_measure</span><span class="o">.</span><span class="n">expectation</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t7_12_0.png" src="../_images/tutorials_t7_12_0.png" />
</div>
</div>
<p>The posterior measure returned by the <code class="docutils literal notranslate"><span class="pre">LinearBayesianInversion</span></code> class does not have a covariance in factored form nor otherwise have a sampling method set. The action of this covariance on any given pair of model vectors can be readily computed, and hence we can explore the uncertainty along directions in the model space.</p>
<p>To gain a fuller understanding of the model uncertainty, one option is to compute the posterior covariance in dense form and then factor it so as to allow for sampling. The cost of this calculation will, however, generally be very high as due to the model space dimension. A typically preferable method is based on a low rank Cholesky factorisation of the posterior covariance. This is implemented in the method <code class="docutils literal notranslate"><span class="pre">low_rank_approximation</span></code> within the <code class="docutils literal notranslate"><span class="pre">GaussianMeasure</span></code> class. The factorisation is
done using randomised methods, and can be based on either a fixed or variable rank factorisation.</p>
<p>In the code below we use a variable rank factorisation, setting also the relative tolerance in estimating the associated error:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_rank_posterior_approximation</span> <span class="o">=</span> <span class="n">model_posterior_measure</span><span class="o">.</span><span class="n">low_rank_approximation</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Once this low rank approximation is formed, we can readily sample from the posterior to learn about data uncertainties. For example, we can plot a set of samples:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">observation_points</span><span class="p">,</span> <span class="n">data</span> <span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">standard_deviations</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">number_of_samples</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">low_rank_posterior_approximation</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">number_of_samples</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
    <span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="n">number_of_samples</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t7_16_0.png" src="../_images/tutorials_t7_16_0.png" />
</div>
</div>
<p>We can also use a set of such samples to estimate the pointwise standard deviation for the the posterior measure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_pointwise_variance</span> <span class="o">=</span> <span class="n">low_rank_posterior_approximation</span><span class="o">.</span><span class="n">sample_pointwise_variance</span><span class="p">(</span><span class="n">number_of_samples</span><span class="p">)</span>
<span class="n">model_pointwise_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">model_pointwise_variance</span><span class="p">)</span>


<span class="c1"># Plot the</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">observation_points</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">standard_deviations</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">model_posterior_measure</span><span class="o">.</span><span class="n">expectation</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span>
<span class="p">)</span>
<span class="n">model_space</span><span class="o">.</span><span class="n">plot_error_bounds</span><span class="p">(</span>
    <span class="n">model_posterior_measure</span><span class="o">.</span><span class="n">expectation</span><span class="p">,</span>
    <span class="mi">2</span> <span class="o">*</span> <span class="n">model_pointwise_std</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t7_18_0.png" src="../_images/tutorials_t7_18_0.png" />
</div>
</div>
<p>A significant appeal of Bayesian methods is that they provide a measure of uncertainty on the models produced. But it must be rememebered that these answers are only as good as the prior probability distribution, and that within inverse problems there is rarely enough data for the choice of prior to be immaterial.</p>
<p>In the code below, we repeat the calculations above, using the same model and data, but now using a different prior.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the new model prior.</span>
<span class="n">new_covariance_length_scale</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">new_covariance_amplitude</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">new_model_prior_measure</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">heat_gaussian_measure</span><span class="p">(</span><span class="n">new_covariance_length_scale</span><span class="p">,</span> <span class="n">new_covariance_amplitude</span><span class="p">)</span>

<span class="c1"># Set up the inversion and form the posterior.</span>
<span class="n">new_bayesian_inversion</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">LinearBayesianInversion</span><span class="p">(</span><span class="n">forward_problem</span><span class="p">,</span> <span class="n">new_model_prior_measure</span><span class="p">)</span>
<span class="n">new_model_posterior_measure</span> <span class="o">=</span> <span class="n">new_bayesian_inversion</span><span class="o">.</span><span class="n">model_posterior_measure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span>

<span class="c1"># Form the low rank approximation</span>
<span class="n">new_low_rank_posterior_approximation</span> <span class="o">=</span> <span class="n">new_model_posterior_measure</span><span class="o">.</span><span class="n">low_rank_approximation</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>

<span class="c1"># Plot the posterior expectation with uncertainty bounds.</span>

<span class="n">new_model_pointwise_variance</span> <span class="o">=</span> <span class="n">new_low_rank_posterior_approximation</span><span class="o">.</span><span class="n">sample_pointwise_variance</span><span class="p">(</span><span class="n">number_of_samples</span><span class="p">)</span>
<span class="n">new_model_pointwise_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">new_model_pointwise_variance</span><span class="p">)</span>


<span class="c1"># Plot the</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">observation_points</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">standard_deviations</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">new_model_posterior_measure</span><span class="o">.</span><span class="n">expectation</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span>
<span class="p">)</span>
<span class="n">model_space</span><span class="o">.</span><span class="n">plot_error_bounds</span><span class="p">(</span>
    <span class="n">new_model_posterior_measure</span><span class="o">.</span><span class="n">expectation</span><span class="p">,</span>
    <span class="mi">2</span> <span class="o">*</span> <span class="n">new_model_pointwise_std</span><span class="p">,</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t7_20_0.png" src="../_images/tutorials_t7_20_0.png" />
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../api/hilbert_space.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">pygeoinf.hilbert_space</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="t6.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorial 6 - Minumum norm inversions</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, David Al-Attar, Dan Heathcote, Adrian Mag
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>